document.addEventListener("DOMContentLoaded",function(){let n=document.getElementById("timerDisplay"),e=document.getElementById("startPauseBtn");var t=document.getElementById("resetBtn"),a=document.querySelectorAll(".timer-presets button");let s=new bootstrap.Modal(document.getElementById("customAlertModal")),r=document.getElementById("customAlertModalBody");(new Tone.Synth).toDestination();let i=new Tone.Synth({oscillator:{type:"sine"},envelope:{attack:.01,decay:.1,sustain:.05,release:.1}}).toDestination(),l;function o(){{let e=0,t=Math.floor(5e3/300);l&&clearInterval(l),l=setInterval(()=>{e<t?(i.triggerAttackRelease("C6","0.2s"),e++):clearInterval(l)},300)}}function c(e){r.textContent=e,s.show()}let d,m=0,u=0,v=!1;let y=document.querySelector(".timer-ring-progress");function f(){var e,t;n.textContent=(e=m,t=Math.floor(e/60),e%=60,String(t).padStart(2,"0")+":"+String(e).padStart(2,"0")),0<m&&0<u?(t=439.82*(m/u),y.style.strokeDashoffset=t):y.style.strokeDashoffset=439.82}function g(){clearInterval(d),l&&clearInterval(l),v=!1,e.innerHTML='<i class="bi bi-play-fill me-2"></i>Start',e.classList.remove("btn-warning"),e.classList.add("btn-primary")}function p(e,t){g(),m=60*e+t,u=m,f()}e&&e.addEventListener("click",()=>{v?g():0===m?c("Please set a time or select a preset before starting."):("running"!==Tone.context.state&&Tone.start(),v||(v=!0,e.innerHTML='<i class="bi bi-pause-fill me-2"></i>Pause',e.classList.remove("btn-primary"),e.classList.add("btn-warning"),d=setInterval(()=>{0<m?(m--,f()):(clearInterval(d),v=!1,e.innerHTML='<i class="bi bi-play-fill me-2"></i>Start',e.classList.remove("btn-warning"),e.classList.add("btn-primary"),o(),c("Time's up! Rest or next set!"))},1e3)))}),t&&t.addEventListener("click",function(){g(),m=0,f()}),a&&a.forEach(e=>{e.addEventListener("click",function(){p(parseInt(this.dataset.minutes),parseInt(this.dataset.seconds))})});let I=document.getElementById("customMinutes"),b=document.getElementById("customSeconds");t=document.getElementById("setCustomTimeBtn");t&&t.addEventListener("click",()=>{var e=parseInt(I.value),t=parseInt(b.value);isNaN(e)||e<0||59<e?c("Please enter a valid number of minutes (0-59)."):isNaN(t)||t<0||59<t?c("Please enter a valid number of seconds (0-59)."):0===e&&0===t?c("Please enter a time greater than 0."):p(e,t)}),f()});